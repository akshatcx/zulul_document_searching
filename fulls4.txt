'ultra-reliable low latency communication urllc one target use cases 5g however performance requirements type traffic yet met challenging use cases industrial internet things iot moreover little work done medium access control mac layer massive multipleinput multiple-out mimo key technology 5g mechanisms urllc traffic lacking paper present mac scheme alarm traffic industrial control networks based massive mimo massive mimo pilots ‚Äî known signals needed obtain channel state information csi user ‚Äî limited resource formulate general problem allocation pilot signals alarm sources trigger alarms unusual events occur example machine failures control values detected outside specified safe parameter range present algorithm efficient pilot allocation guarantees alarm delivery performed simulation study shows good performance algorithm work supported national science centre poland grant 2017/25/b/st7/02313 ‚Äú packet routing transmission scheduling optimization multi-hop wireless networks multicast traffic ‚Äù work emma fitzgerald also partially supported celtic-next project 5g perfecta ssf project sec4factory grant ssf rit17-0032 strategic research area elliit varying numbers alarms alarm trigger probabilities average case alarm trigger probability 1 per alarm slot less 1.5 pilots per time slot needed reserved alarm traffic alarms delivered within two slots worst case alarms delivered within average just 4 slots 3.5 pilots needed per slot length time slot scheme equal transmission time interval 5g short 125 ¬µs rise industry 4.0 comes greater need flexibility manufacturing industrial processes key features industry 4.0 include optimisation customisation production automation adaption automatic data exchange communication realtime capability decentralisation modularity important operating principles trends facilitated transition wireless communications industrial control processes allowing cheaper scalable communications reduced cabling costs ability easily reconfigure factory floor however yet development deployment wireless protocols suitable real-time communication context limited since existing protocols able meet stringent requirements industrial control traffic terms latency allowable packet loss rates massive mimo promising technology domain diversity gain greatly increase reliability communications industrial systems example diversity gain 90 db margin needed fading gain order reach channel outage probability suitable factory process automation diversity order 15 reduced 9 db massive mimo use hundreds antennas inherently provides high degree spatial diversity equal number antennas using maximum ratio combining number antennas minus number concurrent users zero forcing moreover effect known channel hardening makes massive mimo channels behave like wired channels smoothing channel variations providing predictable performance effect facilitated low correlation channels different users otherwise challenging radio arxiv:1909.11482v1 25 sep 2019 environment factory thus turned strength metallic fixtures moving machine tools robots provide rich multipath channel propagation environment aids differentiation user signals massive mimo systems order take advantage benefits promised massive mimo industrial communications suitable mac protocols needed however thus far work massive mimo mac iot limited especially comes urllc few recent works consider random access and/or grant-free protocols massive mimo iot scenarios ‚Äì particular argues advantages massive mimo technologies presence massively many devices transmitting intermittently scheduled access periodic iot traffic also considered however none works cater particular needs industrial control traffic terms packet loss latency guarantees address paper rest paper organised follows section ii formulate pilot allocation problem define traffic model performance requirements section iii presents pilot allocation algorithm based new concept call collision trees section iv details simulationbased performance study results finally section v concludes paper ii pilot allocation alarm traffic problem address pilot allocation alarm traffic 5g industrial internet things scenario typically use case dedicated network network slice would used consider traffic other applications scenario massive mimo base station provides communications continuous control traffic sporadic critical alarm traffic order communicate traffic classes must allocated pilot signals way guarantee delivery alarms also maintaining high performance control traffic massive mimo transmission provide brief overview transmission massive mimo systems comprehensive treatment found transmission time division duplex-based massive mimo occurs coherence blocks consisting time interval frequency band across channel constant within small margin error coherence block contains number channel resource elements used downlink uplink data uplink pilot signals pilot signals used measure channel state information user must orthogonal csi fed preprocessing matrix used direct data stream respective recipient downlink differentiate incoming data stream uplink two users transmit pilot signal coherence block csi users inaccurate data encoded decoded incorrectly phenomenon known pilot contamination effectively results collision user transmissions way interference single-antenna wireless systems collisions avoided allocating user unique orthogonal pilot sporadic alarm traffic would result inefficient use resources since time pilots go unused one key difference collisions due pilot contamination collisions single-antenna systems former base station able communicate users involved collision via multicast transmission using combined csi effectively contaminated pilot provides csi involved users group users group different received power may fail receive transmission however scenario unlikely since small indoor cells user far base station multicast transmissions specific group users involved collision give us new possibilities handle collisions example allocating dedicated resources pilots collision resolution proposed algorithm section iii make use capability b traffic classes requirements efficient pilot allocation depends traffic served strike right balance wastage resources due collisions due unused pilots scenario traffic consists two classes control traffic alarm traffic control traffic encompasses transmissions machines factory floor controllers traffic regular some cases even deterministic stringent latency requirements order arrive within specified control loop period work however alarm traffic main focus control traffic regarded base load traffic evaluate performance impact serving alarm traffic alarms infrequent unpredictable nonetheless must delivered reliably making resource allocation alarm traffic challenging goal thus provide delivery guarantees alarm traffic minimising pilot resources required two key performance requirements industrial automation traffic latency packet loss probability values depend specific industrial automation domain domains focus process automation update frequency 10 1000 ms factory automation update frequency 500 ¬µs 100 ms two domains interest work update frequencies sufficiently fast require pilot allocation strategies cater specifically also slow enough feasible realise using 5g transmission time interval ranges 125 ¬µs 1 ms packet loss rate required targeted domains 1 √ó 10‚àí9 extremely low loss rate includes potential causes packet loss aim 100 delivery guarantees pilot allocation strategy packet lost due failure resource allocation collision resolution packet loss rate latency requirements thus considered jointly inherently tied together pilot allocation scheme packet loss still occur other reasons noise beyond scope current work c. alarm traffic model performance given pilot allocation strategy depends characteristics alarm traffic adopt following alarm traffic model define window consisting time slots slot represents one coherence interval may multiple coherence blocks different frequencies within slot p pilots available total pilot assigned one users slot two users assigned pilot given slot collision occur transmit slot pilot also unused wasted assigned user do transmit slot set alarm sources represents one type alarm arise window window limited time defined two reasons first set alarms may occur change time example factory floor reconfigured second time scale alarms need served may very different reset example alarm may triggered upon malfunction given machine necessitating machine shut quickly however time repair machine may much longer machine nonoperational longer possible alarm triggered window therefore interval time set possible alarms constant alarm ‚àà probability p be triggered slot triggered alarm be triggered within window reality alarm trigger probabilities could be correlated begin assuming independent alarms simplify analysis consider correlated alarms future work triggered alarm also deadline number slots within must be successfully received base station given alarm successful first transmission attempt example collision attempt retransmission deadline according pilot allocation scheme assume alarm messages short enough be transmitted within single slot d. pilot allocation problem problem define pilot allocation scheme guarantees delivery alarms within deadlines naive strategy could be simply assign one pilot alarm every slot would certainly guarantee alarm delivery would be very inefficient since probability alarm triggered very low let alone given slot moreover many possible alarms may be enough pilots slot uniquely assign one alarm source goal therefore be minimise number pilots need be assigned alarms still guaranteeing delivery formally define pilot allocation scheme finite sequence pilots defined each alarm source given alarm source alarm triggered begins transmitting alarm message next slot using first pilot its pilot sequence collision attempts retransmission following slot using second pilot its sequence alarm source know there collision fail receive acknowledgement base station downlink phase coherence block transmits upon collisions alarm source proceeds along sequence one slot time reaches end its final retransmission attempt pilot sequence may also contain blank pilots indicating alarm source remains silent corresponding slot instead attempting retransmission collision occurs base station optionally transmit pilot offset alarm sources involved collision using multicast transmission described section ii-a case alarm sources add pilot offset next value pilot sequences example alarm ‚àà pilot 1 its next allocated pilot alarm b ‚àà pilot 2 its next pilot base station transmits pilot offset 10 alarm transmit using pilot 11 next slot b transmit using pilot 12 pilot offset thus allows dynamic pilot allocation base station still fixed pre-determined sequences each alarm source see section iii simplify collision resolution since each collision be resolved its pilot range parallel any new alarm transmissions sufficient condition guarantee alarm delivery within deadline each pilot sequence be longer number slots alarm triggering its deadline last pilot each alarm ‚Äô sequence be unique across set alarms alarm source unique pilot allocated given slot be able transmit its alarm message without any risk collision thus guaranteeing delivery slot since there reason continue retransmission collision-free transmission guaranteed specify unique pilot condition be met last pilot each sequence length sequence more number slots deadline alarm be sent without collision worst case last slot deadline iii pilot allocation using collision trees section present efficient pilot allocation algorithm guarantee alarm delivery algorithm based concept call collision trees method assigning pilot sequences alarms alarms lower trigger probabilities longer sequences share pilots other alarms more often shared pilots entail risk collision least two alarms sharing pilot triggered same time therefore beneficial lower probability alarms share pilots more higher fig 1 example pilot allocation alarm transmission collision resolution collision 1 four pilots allocated following slot collision resolution this resolve alarms collision two pilots allocated next slot collision resolved similarly collision 2 requires first four pilots two finally one third slot following initial transmission probability alarms authors ‚Äô python implementation collision tree algorithm available download use gnu general public license a. algorithm description begin allocating single common pilot alarms slots common pilot used initial alarm transmissions alarm sources without requiring prior grant channel access best case alarms triggered window arrive different slots pilots need be allocated them each transmit without collision common pilot event collision however resolve collision its isolated pilot range facilitated base station transmitting pilot offset involved alarm sources this allows us consider only alarms involved collision ignore any alarms arrive collision resolution these will be sent using common pilot necessary undergo collision resolution separate pilot range affecting original collision resolution process this somewhat reduces efficiency collision resolution however it greatly simplifies design pilot allocation scheme allows us more easily guarantee alarm delivery example pilot allocation collision resolution shown figure 1 collision occurred involved alarm sources attempt retransmission according their predefined pilot sequences see section ii-d design these sequences will use collision trees inspired trees used create huffman codes collision tree equal v e constructed follows begin set alarms together their trigger probabilities p ‚àà each alarm will become leaf collision tree combine two alarms lowest probabilities making them children parent node also probability associated it namely probability least one its children alarms triggered repeat procedure combining two nodes lowest probabilities do yet parent nodes making them children newly created parent node fig 2 example collision tree five alarm sources leaf nodes representing alarms shown grey each node ‚Äô probability shown it pilot assigned each node shown blue its right probability new node given probability least one alarms its child subtree triggered this process continues iterate finally left single node which will become root node tree whose probability equal the probability any alarm triggered given slot given node v ‚àà v the tree the probability least one the alarms its subtree triggered given œÄ v equal 1 ‚àí l‚ààl v 1 ‚àí œÄ l 1 l v the set leaf nodes descended v œÄ l l ‚àà v leaf node the tree equal the probability the associated alarm triggered œÄ l equal p l l ‚àà the alarm associated leaf node l ‚àà v. the tree has constructed need assign pilots each node the tree each level the tree represents one time slot the collision resolution process nodes the tree must be assigned pilots unique within their level this feasible long the number nodes any level does exceed the total number pilots available each time slot assign pilots simply label the nodes each level pilot numbers starting 1 increasing the number nodes the level the root the tree assigned the common pilot initial alarm transmissions determine the pilot sequence given alarm then read order the pilots assigned each node the path the root the leaf node corresponding the alarm example collision tree shown figure 2 five alarms a1 a5 trigger probabilities p a1 equal 0.6 p a2 equal 0.35 p a3 equal 0.3 p a4 equal 0.15 p a5 equal 0.15 first a4 a5 combined since the lowest trigger probabilities placed children new node v4 the probability v4 given œÄ v4 equal 1 ‚àí 1 ‚àí 0.15 1 ‚àí 0.15 equal 0.278 the next two orphan nodes nodes without parent the lowest probabilities then a2 a3 which placed the children new node v3 probability 1 ‚àí 1 ‚àí 0.3 1 ‚àí 0.35 equal 0.545 the two orphan nodes the lowest probabilities v3 v4 so they placed the children new node v2 probability 1 ‚àí 1 ‚àí 0.35 1 ‚àí 0.3 1 ‚àí 0.15 1 ‚àí 0.15 equal 0.671 finally only two orphan nodes remaining so they placed the children the new root node v1 probability 0.869 which the probability least one the alarms triggering the resulting collision tree has four levels corresponding maximum four slots needed resolve alarms the maximum number pilots would need be reserved any slot four slot t 3 t the slot which the alarms first transmitted b performance analysis there two key performance metrics interest assessing the quality given pilot allocation scheme the first the delivery time the alarms the second the expected number pilots reserved alarms these then be used control traffic the delivery time be considered each individual alarm the entire set alarms taking aggregate measures across the set the maximum delivery time any given alarm given simply the length its pilot sequence collision tree-based allocation this equivalently the length the path the leaf node associated the alarm the root the tree can express this dÀÜ equal |r l dÀÜ a the maximum delivery time alarm a ‚àà a time slots l a ‚àà v the leaf node the tree associated alarm a r v v ‚àà v the path a node v the root the tree consisting the parent node v followed the parent node v ‚Äô parent so the root node the maximum delivery time can be used determine whether alarm a can be guaranteed delivery within its deadline dÀÜ a less equal the number time slots a ‚Äô deadline then delivery within the deadline ensured default our collision tree algorithm guarantees delivery alarms not necessarily within their deadlines however checking the maximum delivery time each alarm its deadline the tree can easily be modified ensure all alarms meet their deadlines albeit some loss performance this can be done moving alarm node l a up the tree along r l a dÀÜ a within the deadline first l a moved up one level become a sibling its parent its grandparent node its new parent the deadline still not met this procedure repeated so l a next becomes a sibling its grandparent then its great-grandparent so needed addition the maximum delivery time the expected delivery time each alarm also important even though the deadline represents the absolute latest time alarm can be delivered not all delivery times within the deadline necessarily equal it may be beneficial deliver the alarm sooner rather later our collision tree algorithm seeks minimise the probability alarm will use its entire pilot sequence order be delivered so the expected delivery time will be significantly shorter the maximum note delivery time analogous codeword length huffman codes its analysis more complicated alarms do not always use their full pilot sequence the expected delivery time each alarm general not equal its maximum delivery time since huffman codes optimal terms encoded message length our collision trees will also be optimal terms maximum delivery times alarms not necessarily terms expected delivery time more analysis needed prove disprove this result will be the subject our future work the expected delivery time alarm a ‚àà a depends the collision probabilities each node r ‚àà r l a ‚Äî the probability a collision occurring the pilot assigned node r its slot this probability given c v equal 1 ‚àí x l‚ààl v œÄ l m‚ààl v 1 ‚àí œÄ ‚àí l‚ààl v 1 ‚àí œÄ l 2 the complement the probability either none the alarms sharing the pilot assigned v triggered only one them soon two or more alarms transmit a collision will occur however determining the expected delivery time a given alarm a specific alarm must have been triggered so need find the conditional collision probability given a triggered this case it sufficient any one the other alarms also covered v be triggered so the conditional probability a collision v given a triggered c v a equal 1 ‚àí m‚ààl v 1 ‚àí œÄ 3 the expected delivery time alarm a then given e equal 1 x r‚ààr l a c r a 4 a the random variable representing the delivery time alarm a v0 the root node the tree the minimum delivery time always one slot representing the case the alarm delivered straight away without collision the event a collision an additional slot then added each node along the path r l a which there a collision note a collision at node v ‚àà v also implies a collision at all nodes along r v the collision probability at any leaf node 0 finally order obtain an aggregate performance metric across all alarms can take the average delivery time across the alarms d equal 1 |a| x a‚ààa e 5 our second performance consideration the effect our pilot allocation scheme the control traffic terms the total expected number pilots reserved alarm traffic per slot including pilots allocated collision resolution however calculating the expected number reserved pilots our alarm traffic model is not straightforward since an alarm is triggered it can no longer be triggered it is thus removed the set possible alarms consequently the probability a collision will be lower subsequent slots meaning the expected number reserved pilots each slot will reduce monotonically move the time window alarms triggered calculate the expectation all slots would therefore need consider all possible combinations which alarms could trigger the same slots which order which is not feasible do practice will therefore take a performance measure the a priori expected number pilots reserved per slot that is the expected number pilots needed alarms per slot assuming all alarms can be triggered this will give an upper bound the true expectation alarms can only be triggered the a priori expected number pilots reserved alarm traffic is given eÀÜ equal 1 x v‚ààv\ c r v 6 eÀÜ denotes the a priori expectation defined p is the random variable representing the number pilots reserved alarm traffic per slot r v v ‚àà v is the parent node v. one pilot is needed each node whose parent node has a collision an additional pilot the root node the common pilot reserved all blocks alarms the two performance metrics discussed do not take account the effect alarms removed the set possible alarms they have been triggered so will overestimate the real performance however they provide an indication the worst case performance no alarms have yet been triggered so assist dimensioning the network these metrics provide a means compare different collision trees produced either the algorithm given section iii or others example these metrics could be used optimise the collision tree which intend explore our future work iv simulation study order empirically test the performance the collision tree algorithm implemented a simulator python alarm pilot allocation along numerical functions the performance metrics detailed section iii-b the full code is available online a. simulation the simulation proceeds follows first a set alarms a is generated each a ‚àà a a per time slot trigger probability p a 0 p p is a simulation parameter we tested the following values p 0.001 0.005 0.01 0.05 0.1 0.5 some these trigger probabilities unrealistically high practical scenarios they are useful find the limits the system ‚Äô capabilities the number alarms a that is |a| also varied 10 100 steps 10 note that this is the total number possible alarms that can arrive the actual triggering these alarms depends the trigger probabilities not all will necessarily be triggered any given simulation                           fig 3 delivery times alarms trigger probability upper bound p equal 0.01 average across all simulation runs instances simulation average maximum each simulation run averaged across all runs instances simulation max analytical average delivery time d analysis equation 5 each configuration these two parameters 20 problem instances instances a along p a ‚àà each a ‚àà a generated each such instance a collision tree built the trigger probabilities p a using the algorithm described section iii-a the collision tree we calculated the analytical performance metrics specifically the average alarm delivery time equation 5 the a priori expected number pilots used per slot equation 6 finally the actual simulation then run 50 times each instance a window size 50 slots the simulation each slot a random number is drawn 0 1 each alarm that has not yet been triggered this number is lower the alarm ‚Äô trigger probability p a the alarm is triggered that slot if more one alarm is triggered a collision occurs is resolved using the collision tree subsequent slots once the window has ended no more alarms are triggered the simulation continues until all remaining collisions are resolved b results a selection simulation results are shown figures 3 4 full results can be obtained downloading running the simulation code we show the results p equal 0.01 which gives relatively high nonetheless realistic trigger probabilities some simulations no alarms are triggered these cases both the average maximum delivery times set 1.0 were the average maximum pilots per slot since an alarm always needs at least one pilot one slot be delivered this thus gives a minimum value all results are shown 95 confidence intervals the maximum delivery time a given alarm can be theoretically high |a| slots the worst case the collision tree is unbalanced such that there is one leaf each level the tree however the delivery time results figure 3 show practice the delivery times                           fig 4 pilots reserved alarms per slot trigger probability upper bound p equal 0.01 average across all simulation runs instances simulation average maximum each simulation run averaged across all runs instances simulation max analytical average delivery time eÀÜ analysis equation 6 shorter using our collision tree algorithm average less 2 slots a maximum around 4 slots p equal 0.01 the analytical average delivery time tracked the maximum giving an indication the worst case performance it provides an upper bound the actual average since it does not take account alarms removed they are triggered delivery times increased p however even the highest value tested p equal 0.5 100 alarms the maximum delivery time less 8 slots the average around 4 slots showing that our algorithm effectively controls the delivery time even challenging cases the collision tree algorithm also showed good performance regards the number pilots reserved alarms per slot figure 4 the analytical metric eÀÜ followed the simulation average low medium values p although at higher values the analysis diverges the simulation average the maximum number pilots reserved alarms approximately 3.5 pilots with 100 alarms a maximum trigger probability 0.01 this shows that the disruption control traffic is limited even cases where many alarms are triggered at once moreover the average number pilots reserved per slot was very low less than 1.5 the collision tree algorithm is thus able guarantee alarm delivery while making very efficient use pilot resources realistic alarm traffic as p increases both the average maximum number pilots used also increase with a maximum number pilots 17.5 p equal to 0.1 56 p equal to 0.5 this gives an indication of the maximum traffic that can be accommodated a single base station using our approach v. conclusion this paper we have studied a new problem in urllc traffic in 5g networks that of massive mimo pilot allocation alarm traffic in industrial internet of things scenarios in particular factory process automation we have presented a grant-free random access scheme alarm traffic together with an algorithm for pilot collision resolution that can guarantee alarm delivery while making efficient use of pilot resources in our future work we plan to further investigate the performance alarm deadlines are shorter than their initial assigned pilot sequence length necessitating moving some alarms further up the collision tree we also aim to find optimal collision trees compare them with generated using our algorithm as well as compare the performance of collision trees with other contention resolution methods other possible directions for future work include modelling simulation of control traffic as well as studying different traffic distributions for alarms correlation alarm